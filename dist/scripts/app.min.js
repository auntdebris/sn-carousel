!function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],r=n.length,i=window.console=window.console||{};r--;)e=n[r],i[e]||(i[e]=t)}(),function(e){var t,n,r,i=e.event,o={_:0},l=0;t=i.special.throttledresize={setup:function(){e(this).on("resize",t.handler)},teardown:function(){e(this).off("resize",t.handler)},handler:function(a,s){var d=this,c=arguments;n=!0,r||(setInterval(function(){l++,(l>t.threshold&&n||s)&&(a.type="throttledresize",i.dispatch.apply(d,c),n=!1,l=0),l>9&&(e(o).stop(),r=!1,l=0)},30),r=!0)},threshold:0}}(jQuery);
!function(e,t,o,s){function i(t,o){this.element=t,this.options=e.extend({},r,o),this._defaults=r,this._name=n,this.itemElems=[],this.itemTmpl=e("#"+this.options.loadFromJSON.template).html(),this.itemContainer=e(this.element).find("."+this.options.container.className),this.numPages=[],this.numCols=[],this.dots=[],this.currentPage={small:0,medium:0,large:0},this.init()}var n="carousel",r={sizes:{small:400,medium:800,large:980},itemsPerPage:{small:1,medium:2,large:4},paths:{images:"images"},classes:{active:"active",disabled:"disabled",hidden:"hidden"},container:{className:"carousel__container"},controls:{className:"carousel__controls",allowKeyboard:!0,allowDrag:!0,allowTouch:!0,show:{small:!0,medium:!0,large:!0}},arrows:{className:"carousel__arrows",prev:{className:"carousel__arrow carousel__arrow--prev",text:"Previous page"},next:{className:"carousel__arrow carousel__arrow--next",text:"Next page"},show:{small:!0,medium:!0,large:!0}},dots:{className:"carousel__dots",dot:{className:"carousel__dot",text:"Page "},show:{small:!1,medium:!0,large:!0}},loadFromJSON:{enabled:!0,url:"",template:""},lazyload:!0};i.prototype.init=function(){var e=this;e.initItems(),e.handleResize()},i.prototype.isInViewport=function(){var o=this,s=e(t).height(),i=e(t).scrollTop(),n=e(o.element).offset().top,r=i+s;return r>n&&n+s+e(o.element).height()>r},i.prototype.setContainerSize=function(){var e=this;e.containerSize=e.itemContainer.width()},i.prototype.setScreenSize=function(){var o=this;o.windowWidth=e(t).width(),o.screenSize=o.windowWidth<=o.options.sizes.small?"small":o.windowWidth<=o.options.sizes.medium?"medium":"large"},i.prototype.setNumPages=function(){var t=this;e.each(t.options.itemsPerPage,function(e,o){t.numPages[e]=Math.ceil(t.itemCount/o)})},i.prototype.setNumCols=function(){var t=this;e.each(t.options.itemsPerPage,function(e,o){t.numCols[e]=o})},i.prototype.getScreenSize=function(){var e=this;return e.setScreenSize(),e.screenSize},i.prototype.getContainerSize=function(){var e=this;return e.setContainerSize(),e.containerSize},i.prototype.getNumCols=function(){var e=this;return e.setNumCols(),e.numCols[e.screenSize]},i.prototype.getNumPages=function(){var e=this;return e.setNumPages(),e.numPages[e.screenSize]},i.prototype.handleResize=function(){var o=this;e(t).on("resize",{_this:this},function(e){o.resizeItems(),o.resizeContainer(),o.updateControlVisibility(),o.createControls(),o.initKeyboard(),o.goToPage(0)})},i.prototype.initItems=function(){var e=this;e.getItems()},i.prototype.getItems=function(){var t=this,o=t.options.loadFromJSON.url;e.getJSON(o,function(e){t.items=e.data.carousel.items,t.itemCount=t.items.length,t.createItems(),t.createControls()}).done(function(){}).fail(function(){}).always(function(){})},i.prototype.createItems=function(){function t(t,o){var i=0;return o.linkTitle=o.title,o.imgPath=s.options.paths.images,e.each(o,function(e,s){return t=t.replace("{{"+e+"}}",s),i++,i===o.length-1?t:void 0}),t}var o,s=this;s.itemContainer.empty().append("<ul>"),e.each(s.items,function(e,i){o=t(s.itemTmpl,i),s.itemContainer.find("ul").append(o),s.itemElems.push(o),e===s.items.length-1&&(s.currentPage[s.screenSize]=0,s.loadItemImages(),s.resizeItems(),s.resizeContainer())})},i.prototype.loadItemImages=function(){var t=this;t.options.lazyload||e.each(t.itemContainer.find("img"),function(t,o){e(o).attr("src",e(o).data("src"))})},i.prototype.resizeItems=function(){var t=this;t.setContainerSize(),t.setScreenSize(),t.setNumPages(),t.setNumCols(),t.itemWidth=t.containerSize/t.numCols[t.screenSize],e.each(t.itemContainer.find("li"),function(o,s){e(s).width(t.itemWidth)})},i.prototype.resizeContainer=function(){var e=this;e.itemList=e.itemContainer.find("ul"),e.itemList.width(e.getContainerSize()*e.numPages[e.screenSize])},i.prototype.createControls=function(){var t=this;t.controls&&t.controls.remove(),t.controls=e("<div class="+t.options.controls.className+"><div></div></div>"),e(t.element).append(t.controls),t.createArrows(),t.createDots(),t.options.controls.allowKeyboard&&t.initKeyboard()},i.prototype.updateControls=function(){var e=this;e.updateArrows(),e.updateDots()},i.prototype.updateControlVisibility=function(){var e=this;e.updateArrowVisibility(),e.updateDotVisibility()},i.prototype.createArrows=function(){var t=this;t.arrowContainer=e("<div class="+t.options.arrows.className+">"),t.arrowPrev=e('<button class="'+t.options.arrows.prev.className+'"><i aria-hidden="true"></i><span class="visuallyhidden">'+t.options.arrows.prev.text+"</span></button>"),t.arrowNext=e('<button class="'+t.options.arrows.next.className+'"><i aria-hidden="true"></i><span class="visuallyhidden">'+t.options.arrows.next.text+"</span></button>"),t.arrowContainer.append(t.arrowPrev),t.arrowContainer.append(t.arrowNext),t.controls.find("> div").append(t.arrowContainer),t.initArrows()},i.prototype.initArrows=function(){var e=this;e.updateArrows(),e.updateArrowVisibility(),e.arrowPrev.on("click",function(){page=e.currentPage[e.screenSize]-1,e.goToPage(page)}),e.arrowNext.on("click",function(){page=e.currentPage[e.screenSize]+1,e.goToPage(page)})},i.prototype.updateArrows=function(){var e=this;e.arrowPrev.removeClass(e.options.classes.disabled),e.arrowNext.removeClass(e.options.classes.disabled),0===e.currentPage[e.screenSize]?e.arrowPrev.addClass(e.options.classes.disabled):e.currentPage[e.screenSize]===e.numPages[e.screenSize]-1&&e.arrowNext.addClass(e.options.classes.disabled)},i.prototype.createDots=function(){var t,o=this,s=0;for(o.dotContainer=e("<div class="+o.options.dots.className+">"),o.dots=[];s<o.numPages[o.screenSize];)t=e('<button class="'+o.options.dots.dot.className+'"><i aria-hidden="true"></i><span class="visuallyhidden">'+o.options.dots.dot.text+s+"1</span></button>"),o.dotContainer.append(t),o.dots.push(t),s===o.numPages[o.screenSize]-1&&(o.controls.find("> div").append(o.dotContainer),o.initDots()),s++},i.prototype.initDots=function(){var t,o=this;o.updateDots(),o.updateDotVisibility(),o.dotContainer.find("button").on("click",function(){t=e(this).index(),o.goToPage(t)})},i.prototype.updateDots=function(){var t=this;e.each(t.dots,function(o,s){o===t.currentPage[t.screenSize]?(console.log("hi"),e(s).addClass(t.options.classes.active)):e(s).removeClass(t.options.classes.active)})},i.prototype.initKeyboard=function(){var t=this;e(o).off("keydown.carousel-keyboard").on("keydown.carousel-keyboard",function(e){t.isInViewport(t.element)===!0&&(37==e.keyCode&&(console.log(t.currentPage[t.screenSize]-1),t.goToPage(t.currentPage[t.screenSize]-1),e.preventDefault()),39==e.keyCode&&(console.log(t.currentPage[t.screenSize]+1),t.goToPage(t.currentPage[t.screenSize]+1),e.preventDefault()))})},i.prototype.updateArrowVisibility=function(){var e=this;e.arrowContainer.removeClass(e.options.classes.hidden),e.options.arrows.show[e.getScreenSize()]||e.arrowContainer.addClass(e.options.classes.hidden)},i.prototype.updateDotVisibility=function(){var e=this;e.dotContainer.removeClass(e.options.classes.hidden),e.options.dots.show[e.getScreenSize()]||e.dotContainer.addClass(e.options.classes.hidden)},i.prototype.goToPage=function(e){var t=this;0>=e&&(e=0),e>=t.numPages[t.screenSize]&&(e=t.numPages[t.screenSize]-1),e>=0&&e<t.numPages[t.screenSize]&&(t.currentPage[t.screenSize]=e,t.updateControls(),Modernizr.csstransforms3d?t.itemList.css({transform:"translate3d(-"+t.containerSize*t.currentPage[t.screenSize]+"px,0,0)"}):Modernizr.csstransforms?t.itemList.css({transform:"translateX(-"+t.containerSize*t.currentPage[t.screenSize]+"px)"}):Modernizr.csstransitions?t.itemList.css({left:-(t.containerSize*t.currentPage[t.screenSize])}):t.itemList.animate({left:-(t.containerSize*t.currentPage[t.screenSize])},400))},i.prototype.updateAllPages=function(){var t=this;t.currentItem=t.currentPage[t.screenSize]*t.numCols[t.screenSize]+1,e.each(t.options.itemsPerPage,function(e,o){t.currentPage[e]=Math.round(t.currentItem/t.numCols[e])})},e.fn[n]=function(t){return this.each(function(){e.data(this,n,new i(this,t))})}}(jQuery,window,document);
var $carousel=$("#test-carousel"),url=$carousel.data("item-url"),imgurl=$carousel.data("item-imgurl"),template=$carousel.data("item-tmpl"),carouselOptions={sizes:{small:400,medium:800,large:980},itemsPerPage:{small:1,medium:2,large:4},paths:{images:imgurl},classes:{active:"active",disabled:"disabled",hidden:"hidden"},container:{className:"carousel__container"},controls:{className:"carousel__controls",allowKeyboard:!0,allowDrag:!0,allowTouch:!0,show:{small:!0,medium:!0,large:!0}},arrows:{className:"carousel__arrows",prev:{className:"carousel__arrow carousel__arrow--prev",text:"Previous page"},next:{className:"carousel__arrow carousel__arrow--next",text:"Next page"},show:{small:!0,medium:!0,large:!0}},dots:{className:"carousel__dots",dot:{className:"carousel__dot",text:"Page "},show:{small:!1,medium:!0,large:!0}},loadFromJSON:{enabled:!0,url:url,template:template},lazyload:!1};$carousel.carousel(carouselOptions);